---
layout: post
title: "Cracking password hashes in Yclas"
thumbnail: shopfront-480.jpg
date: 2020-01-15
---

<!-- photo source: https://pixabay.com/photos/architecture-facade-brick-old-3290756/ -->

## User input as database column

While investigating Yclas I encountered an [article about cache poisoning](https://portswigger.net/blog/practical-web-cache-poisoning) which mentions the [Param Miner](https://github.com/PortSwigger/param-miner) Burp extension. This extension tries to find GET parameter names or request header names that trigger different behavior in a web page. By brute-forcing a lot of GET parameters, parameter names can be found that trigger functionality in the application.

I ran the "Guess GET parameters" function on a couple of Yclas URLs. It returned several new GET parameters, but these did not seem very interesting and I went on with something else. Then when I viewed the application log, I noticed the following error:

    ERROR: Database_Exception [ 1054 ]: Unknown column 'id_userrskmiy' in 'where clause'

An SQL error where the column name, `id_userrskmiy`, seems to be generated by Burp and used directly in the SQL query. I found the original request triggering this error by grepping the Burp log:

    POST /oc-panel/User/ajax?filter__id_userrskmiy=wrtqvajczva065zr

So it seems that anything following `filter__` is used as the column name to search on.
